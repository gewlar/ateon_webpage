<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no"><meta name=generator content="Hugo 0.83.1"><title>Some technical information about the Polyring widget | Ateon</title><link rel=icon type=image/png href=/favicon.png><title>Some technical information about the Polyring widget - Ateon</title><meta name=description content="Some technical information about the Polyring widget"><meta name=keywords content="css,javascript"><meta property="og:title" content="Some technical information about the Polyring widget"><meta name=twitter:title content="Some technical information about the Polyring widget"><meta property="og:type" content="article"><meta property="og:url" content="https://ateon.ch/blog/some-technical-information-about-the-polyring-widgett/"><meta property="og:description" content="Some technical information about the Polyring widget"><meta name=twitter:description content="Some technical information about the Polyring widget"><meta name=twitter:card content="summary"><meta property="article:published_time" content="2021-04-27T09:03:40+02:00"><meta property="article:modified_time" content="2021-04-27T09:03:40+02:00"><style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style><link rel=stylesheet href=https://ateon.ch/css/main.min.89f35b0097263affc22b3b86e35d6c4ecfa614e7edbcf2f3eeed24268f26f44f.css></head><body data-theme=auto><script data-cfasync=false>var ateonThemeData=localStorage.getItem('ateon_data-theme');ateonThemeData?ateonThemeData!=='auto'&&document.body.setAttribute('data-theme',ateonThemeData==='dark'?'dark':'light'):localStorage.setItem('ateon_data-theme','auto')</script><main><nav><header><div class=site-title><a href=/>Ateon</a></div></header><div class=nav-menu><a class=nav-link href=/blog/index.xml target=_blank rel=noopener type=application/rss+xml>RSS</a></div><footer class=footer><div class=social-icons><a class=social-icon href=mailto://gewlar@ateon.ch target=_blank rel=noopener title=Email><svg width="28" height="28" viewBox="0 0 28 28" fill="#ababab" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><path d="M25.2794292 5.59128519 14 16.8707144 2.72057081 5.59128519C3.06733103 5.30237414 3.51336915 5.12857603 4 5.12857603H24c.4866308.0.932669000000001.173798110000001 1.2794292.46270916zM25.9956978 6.99633695C25.998551 7.04004843 26 7.08414302 26 7.12857603V20.871424C26 21.0798433 25.9681197 21.2808166 25.9089697 21.4697335l-7.1933342-7.1933342 7.2800623-7.28006235zM24.9498374 22.6319215C24.6672737 22.7846939 24.3437653 22.871424 24 22.871424H4C3.5268522 22.871424 3.09207889 22.7071233 2.74962118 22.432463l7.34540352-7.3454036 3.8897821 3.8897821L14.1878486 18.7737996l.0151933.0151933 3.4519334-3.4519335 7.2948621 7.2948621zM2.00810114 21.0526627C2.00273908 20.9929669 2 20.9325153 2 20.871424V7.12857603C2 7.08414302 2.00144896 7.04004843 2.00430222 6.99633695L9.03436454 14.0263993l-7.0262634 7.0262634z"/></svg></a><a class=social-icon href=https://www.linkedin.com/in/luca-schafroth-a7b9b0129/ target=_blank rel=noopener title=LinkedIn><svg width="28" height="28" viewBox="0 0 28 28" fill="#ababab" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><path d="M2 3.654102c0-.95502059.79442509-1.73012354 1.77383592-1.73012354H24.2261641C25.2058917 1.92397846 26 2.69908141 26 3.654102V24.3462148C26 25.3015521 25.2058917 26.0760215 24.2261641 26.0760215H3.77383592C2.79442509 26.0760215 2 25.3015521 2 24.3465315V3.65378524 3.654102zM9.27526132 22.1415901V11.2356668H5.65030092V22.1415901H9.27557808 9.27526132zM7.46341463 9.74691162c1.2638581.0 2.05068103-.83750395 2.05068103-1.88406715C9.49033893 6.79252455 8.72727273 5.97846056 7.48748812 5.97846056c-1.24073487.0-2.05099778.81406399-2.05099778 1.88438391.0 1.0465632.78650618 1.88406715 2.00316756 1.88406715h.02343998H7.46341463zM11.2815965 22.1415901h3.6246436v-6.089642C14.9062401 15.7263225 14.9299968 15.4000634 15.0256573 15.1675641c.261957499999999-.6515679.8584099-1.3259423 1.8599936-1.3259423 1.3113716.0 1.836237 1 1.836237 2.4662654v5.8337029h3.6246436V15.8885017c0-3.349699-1.7880899-4.9084574-4.172949-4.9084574-1.9553373.0-2.814064 1.0928097-3.2910991 1.8371872H14.9065569v-1.581248H11.2819132C11.3291099 12.2591067 11.2815965 22.1419069 11.2815965 22.1419069V22.1415901z"/></svg></a><a class=social-icon href=https://github.com/gewlar target=_blank rel=noopener title=GitHub><svg width="28" height="28" viewBox="0 0 28 28" fill="#ababab" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><path d="M13.9988029 1.32087331C6.82105037 1.32087331 1 7.14112562 1 14.3212723c0 5.7436386 3.72454649 10.6157955 8.89038951 12.3348169C10.5408085 26.7757983 10.7778323 26.374374 10.7778323 26.0296121 10.7778323 25.7215609 10.7666595 24.9035493 10.760275 23.8189856 7.14426471 24.6042767 6.38131925 22.0760223 6.38131925 22.0760223c-.59136253-1.5019491-1.44369072-1.9017772-1.44369072-1.9017772C3.75729765 19.3682044 5.02701126 19.3841656 5.02701126 19.3841656 6.33183953 19.4759425 7.01817121 20.7241085 7.01817121 20.7241085c1.15958133 1.9863716 3.04300319 1.4125664 3.78360289 1.0797753.1181129-.8395592.4540962-1.4125663.8251942-1.7373768C8.74038491 19.7385043 5.70536235 18.6228163 5.70536235 13.6413251c0-1.4189508.50676816-2.5801283 1.33834679-3.4883207C6.90963504 9.82420367 6.46351945 8.50181809 7.17139875 6.71256734c0 0 1.09094816-.34955032 3.57451115 1.33276037C11.78259 7.75642995 12.8950858 7.61277914 14.000399 7.60719272 15.1049142 7.61277914 16.2166119 7.75642995 17.2548881 8.04532771c2.4819669-1.68231069 3.571319-1.33276037 3.571319-1.33276037C21.5356825 8.50181809 21.0895669 9.82420367 20.9562909 10.1530044 21.7894656 11.0611968 22.2922435 12.2223743 22.2922435 13.6413251c0 4.9942601-3.039811 6.0931889-5.935173 6.4148071.4660671.401424200000001.8818564 1.194696.8818564 2.4077473C17.2389269 24.2012564 17.2229657 25.603448 17.2229657 26.0296121 17.2229657 26.3775663 17.4575954 26.7821827 18.116793 26.6552912 23.2786458 24.9322794 27 20.0633148 27 14.3212723 27 7.14112562 21.1789496 1.32087331 13.9988029 1.32087331"/></svg></a></div><webring-banner name=webring></webring-banner></footer></nav><div id=content class=content-container><h1 class=post-title>Some technical information about the Polyring widget</h1><time>April 27, 2021</time><div><p><p>As those following the news about the Polyring may have read on <a href=https://xyquadrat.ch/2021/04/24/polyring-widget-theming.html>xyquadrat</a>, our widget can now be styled with themes. For those interested about the inner workings I will provide some technical information here.</p><p>The component make heavy use of <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties>css variables</a> alongside the attribute <code>theme</code>, which can be set on the component. Let&rsquo;s walk through the needed setup, which consists of both javascript code and css descriptions.</p><h3 id=javascript-setup>Javascript setup</h3><p>Fortunately webcomponents already have the functionally to observe attributes. We can simply declare an attribute as observable using a built-in funciton. This allows for hot-switching instead of only loading the attribute once in the beginning.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>static</span> <span style=color:#a6e22e>get</span> <span style=color:#a6e22e>observedAttributes</span>() {
	<span style=color:#66d9ef>return</span> [<span style=color:#e6db74>&#39;theme&#39;</span>];
}
</code></pre></div><p>Each time the value changes the triggered event can be observed with yet another built-in method. It&rsquo;s usually a good idea to check for the validity of this <code>newVal</code> and if it actually corresponds to our attribute. This is increasingly important if we observe more than just one attribute.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>attributeChangedCallback</span>(<span style=color:#a6e22e>attrName</span>, <span style=color:#a6e22e>oldVal</span>, <span style=color:#a6e22e>newVal</span>) {
    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>attrName</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;theme&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newVal</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>oldVal</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>newVal</span>) {
    	<span style=color:#75715e>// act on new theme
</span><span style=color:#75715e></span>    }
}
</code></pre></div><p>Using a lookup table we can then handle predefined themes, which makes it easier to embed. If the given value is not found in the table, we assume that it must be an url to an external file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>themes</span> <span style=color:#f92672>=</span> {
      <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;assets/themes/default.json&#34;</span>,
      <span style=color:#a6e22e>dark</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;assets/themes/dark.json&#34;</span>
}

<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themes</span>[<span style=color:#a6e22e>newVal</span>] <span style=color:#f92672>??</span> <span style=color:#a6e22e>newVal</span>;
</code></pre></div><p>The corresponding internal or external file is then loaded, parsed as json and each css property is updated. You can find an example for such theme file on [xyquadrat].(<a href=https://xyquadrat.ch/polyring/assets/themes/default.json>https://xyquadrat.ch/polyring/assets/themes/default.json</a>)</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>).<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>response</span> =&gt; <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>json</span>())
    .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>val</span> =&gt; {
    	<span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>item</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>val</span>) {
        	<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>setProperty</span>(<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>val</span>[<span style=color:#a6e22e>item</span>]);
         }              
	}).<span style=color:#66d9ef>catch</span>( <span style=color:#a6e22e>val</span> =&gt; {
    	<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>val</span>);
}); 
</code></pre></div><h3 id=css-setup>CSS setup</h3><p>A <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties>css variable</a> or css custom property can be used with the <code>var</code> function in css. For example for the webring-banner:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>webring-banner</span> {
    <span style=color:#66d9ef>background-color</span>: <span style=color:#a6e22e>var</span>(<span style=color:#f92672>--</span>background<span style=color:#f92672>-</span><span style=color:#66d9ef>color</span>, <span style=color:#ae81ff>#FFF</span>);
    <span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>1</span><span style=color:#66d9ef>px</span> <span style=color:#66d9ef>solid</span> <span style=color:#a6e22e>var</span>(<span style=color:#f92672>--</span>outer<span style=color:#f92672>-</span>border<span style=color:#f92672>-</span><span style=color:#66d9ef>color</span>, <span style=color:#ae81ff>#DDD</span>);
}
</code></pre></div><p>Take note that <code>var</code>allows passing a default value in the format: <code>var(--my-variable, default_value)</code>, but it is not necessary. Basically every kind of css parameter can be used in a variable, so you could have dynamic borders or even hide an element in one theme. These variables can also be stacked to allow for both broad and specific control:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>webring-banner__info</span> {
	<span style=color:#66d9ef>border</span>: <span style=color:#ae81ff>2</span><span style=color:#66d9ef>px</span> <span style=color:#66d9ef>solid</span> <span style=color:#a6e22e>var</span>(<span style=color:#f92672>--</span>inner<span style=color:#f92672>-</span>border<span style=color:#f92672>-</span><span style=color:#66d9ef>color</span>, <span style=color:#a6e22e>var</span>(<span style=color:#f92672>--</span>outer<span style=color:#f92672>-</span>border<span style=color:#f92672>-</span><span style=color:#66d9ef>color</span>, <span style=color:#ae81ff>#DDD</span>));
}
</code></pre></div><p>Additionally if you&rsquo;re using scss and aren&rsquo;t keen on repeating the same var function for each component that uses these properties, you can integrate them with scss variables:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-scss data-lang=scss>$text-color<span style=color:#f92672> :</span> <span style=color:#a6e22e>var</span>(<span style=color:#f92672>--</span>core-text-color<span style=color:#f92672>,</span> black);

<span style=color:#a6e22e>.text</span> {
	<span style=color:#f92672>color</span><span style=color:#a6e22e>:</span> <span style=color:#960050;background-color:#1e0010>$</span><span style=color:#f92672>text-color</span>;
}
</code></pre></div><p>Unfortunately these css custom properties can not be used in scss functions like <code>scale-color</code>. As those are parsed at build time, but the value from a css variables is only present at run time. However css variables can be used in css functions like <code>calc</code>.</p><h3 id=conclusion>Conclusion</h3><p>Css custom properties allow for relatively easy theme support both to your website as well as webcomponents. Many css frameworks like <a href=https://materializecss.com/>Materialize</a> or <a href=https://getbootstrap.com/>Bootstrap</a> make heavy use of css variables to style elements dynamically.</p></p></div><div class=page-footer><hr class=footer-divider><a class=tag href=/tags/css>#css</a>
<a class=tag href=/tags/javascript>#javascript</a></div></div><div class=btn><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div></main><footer class=footer-mobile><div class="center_content margin_bottom"><webring-banner name=webring style="width: auto;"></webring-banner></div><div class=social-icons><a class=social-icon href=mailto://gewlar@ateon.ch target=_blank rel=noopener title=Email><svg width="28" height="28" viewBox="0 0 28 28" fill="#ababab" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><path d="M25.2794292 5.59128519 14 16.8707144 2.72057081 5.59128519C3.06733103 5.30237414 3.51336915 5.12857603 4 5.12857603H24c.4866308.0.932669000000001.173798110000001 1.2794292.46270916zM25.9956978 6.99633695C25.998551 7.04004843 26 7.08414302 26 7.12857603V20.871424C26 21.0798433 25.9681197 21.2808166 25.9089697 21.4697335l-7.1933342-7.1933342 7.2800623-7.28006235zM24.9498374 22.6319215C24.6672737 22.7846939 24.3437653 22.871424 24 22.871424H4C3.5268522 22.871424 3.09207889 22.7071233 2.74962118 22.432463l7.34540352-7.3454036 3.8897821 3.8897821L14.1878486 18.7737996l.0151933.0151933 3.4519334-3.4519335 7.2948621 7.2948621zM2.00810114 21.0526627C2.00273908 20.9929669 2 20.9325153 2 20.871424V7.12857603C2 7.08414302 2.00144896 7.04004843 2.00430222 6.99633695L9.03436454 14.0263993l-7.0262634 7.0262634z"/></svg></a><a class=social-icon href=https://www.linkedin.com/in/luca-schafroth-a7b9b0129/ target=_blank rel=noopener title=LinkedIn><svg width="28" height="28" viewBox="0 0 28 28" fill="#ababab" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><path d="M2 3.654102c0-.95502059.79442509-1.73012354 1.77383592-1.73012354H24.2261641C25.2058917 1.92397846 26 2.69908141 26 3.654102V24.3462148C26 25.3015521 25.2058917 26.0760215 24.2261641 26.0760215H3.77383592C2.79442509 26.0760215 2 25.3015521 2 24.3465315V3.65378524 3.654102zM9.27526132 22.1415901V11.2356668H5.65030092V22.1415901H9.27557808 9.27526132zM7.46341463 9.74691162c1.2638581.0 2.05068103-.83750395 2.05068103-1.88406715C9.49033893 6.79252455 8.72727273 5.97846056 7.48748812 5.97846056c-1.24073487.0-2.05099778.81406399-2.05099778 1.88438391.0 1.0465632.78650618 1.88406715 2.00316756 1.88406715h.02343998H7.46341463zM11.2815965 22.1415901h3.6246436v-6.089642C14.9062401 15.7263225 14.9299968 15.4000634 15.0256573 15.1675641c.261957499999999-.6515679.8584099-1.3259423 1.8599936-1.3259423 1.3113716.0 1.836237 1 1.836237 2.4662654v5.8337029h3.6246436V15.8885017c0-3.349699-1.7880899-4.9084574-4.172949-4.9084574-1.9553373.0-2.814064 1.0928097-3.2910991 1.8371872H14.9065569v-1.581248H11.2819132C11.3291099 12.2591067 11.2815965 22.1419069 11.2815965 22.1419069V22.1415901z"/></svg></a><a class=social-icon href=https://github.com/gewlar target=_blank rel=noopener title=GitHub><svg width="28" height="28" viewBox="0 0 28 28" fill="#ababab" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><path d="M13.9988029 1.32087331C6.82105037 1.32087331 1 7.14112562 1 14.3212723c0 5.7436386 3.72454649 10.6157955 8.89038951 12.3348169C10.5408085 26.7757983 10.7778323 26.374374 10.7778323 26.0296121 10.7778323 25.7215609 10.7666595 24.9035493 10.760275 23.8189856 7.14426471 24.6042767 6.38131925 22.0760223 6.38131925 22.0760223c-.59136253-1.5019491-1.44369072-1.9017772-1.44369072-1.9017772C3.75729765 19.3682044 5.02701126 19.3841656 5.02701126 19.3841656 6.33183953 19.4759425 7.01817121 20.7241085 7.01817121 20.7241085c1.15958133 1.9863716 3.04300319 1.4125664 3.78360289 1.0797753.1181129-.8395592.4540962-1.4125663.8251942-1.7373768C8.74038491 19.7385043 5.70536235 18.6228163 5.70536235 13.6413251c0-1.4189508.50676816-2.5801283 1.33834679-3.4883207C6.90963504 9.82420367 6.46351945 8.50181809 7.17139875 6.71256734c0 0 1.09094816-.34955032 3.57451115 1.33276037C11.78259 7.75642995 12.8950858 7.61277914 14.000399 7.60719272 15.1049142 7.61277914 16.2166119 7.75642995 17.2548881 8.04532771c2.4819669-1.68231069 3.571319-1.33276037 3.571319-1.33276037C21.5356825 8.50181809 21.0895669 9.82420367 20.9562909 10.1530044 21.7894656 11.0611968 22.2922435 12.2223743 22.2922435 13.6413251c0 4.9942601-3.039811 6.0931889-5.935173 6.4148071.4660671.401424200000001.8818564 1.194696.8818564 2.4077473C17.2389269 24.2012564 17.2229657 25.603448 17.2229657 26.0296121 17.2229657 26.3775663 17.4575954 26.7821827 18.116793 26.6552912 23.2786458 24.9322794 27 20.0633148 27 14.3212723 27 7.14112562 21.1789496 1.32087331 13.9988029 1.32087331"/></svg></a></div></footer><script defer src=/assets/js/main.min.js></script><script async src=https://xyquadrat.ch/polyring/embed.js></script></body></html>