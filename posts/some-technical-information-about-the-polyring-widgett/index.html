<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Some technical information about the Polyring widget - Ateon</title><meta name=Description content="Some technical information about the Polyring widget"><meta property="og:title" content="Some technical information about the Polyring widget"><meta property="og:description" content="Some technical information about the Polyring widget"><meta property="og:type" content="article"><meta property="og:url" content="https://ateon.ch/posts/some-technical-information-about-the-polyring-widgett/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-27T09:03:40+02:00"><meta property="article:modified_time" content="2021-04-27T09:03:40+02:00"><meta property="og:site_name" content="Ateon"><meta name=twitter:card content="summary"><meta name=twitter:title content="Some technical information about the Polyring widget"><meta name=twitter:description content="Some technical information about the Polyring widget"><meta name=application-name content="Ateon"><meta name=apple-mobile-web-app-title content="Ateon"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://ateon.ch/posts/some-technical-information-about-the-polyring-widgett/><link rel=prev href=https://ateon.ch/posts/using-steganography-to-send-messages-hidden-in-an-image/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Some technical information about the Polyring widget","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/ateon.ch\/posts\/some-technical-information-about-the-polyring-widgett\/"},"genre":"posts","keywords":"css, javascript, web component","wordcount":502,"url":"https:\/\/ateon.ch\/posts\/some-technical-information-about-the-polyring-widgett\/","datePublished":"2021-04-27T09:03:40+02:00","dateModified":"2021-04-27T09:03:40+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"gewlar"},"description":"Some technical information about the Polyring widget"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Ateon>Ateon</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/about>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Ateon>Ateon</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/about title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Some technical information about the Polyring widget</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>gewlar</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=27.04.2021>27.04.2021</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;502 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#javascript-setup>Javascript setup</a></li><li><a href=#css-setup>CSS setup</a></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>As those following the news about the Polyring may have read on <a href=https://xyquadrat.ch/2021/04/24/polyring-widget-theming.html target=_blank rel="noopener noreffer">xyquadrat</a>, our widget can now be styled with themes. For those interested about the inner workings I will provide some technical information here.</p><p>The component make heavy use of <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties target=_blank rel="noopener noreffer">css variables</a> alongside the attribute <code>theme</code>, which can be set on the component. Let&rsquo;s walk through the needed setup, which consists of both javascript code and css descriptions.</p><h3 id=javascript-setup>Javascript setup</h3><p>Fortunately webcomponents already have the functionally to observe attributes. We can simply declare an attribute as observable using a built-in funciton. This allows for hot-switching instead of only loading the attribute once in the beginning.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>static</span> <span class=nx>get</span> <span class=nx>observedAttributes</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=p>[</span><span class=s1>&#39;theme&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Each time the value changes the triggered event can be observed with yet another built-in method. It&rsquo;s usually a good idea to check for the validity of this <code>newVal</code> and if it actually corresponds to our attribute. This is increasingly important if we observe more than just one attribute.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>attributeChangedCallback</span><span class=p>(</span><span class=nx>attrName</span><span class=p>,</span> <span class=nx>oldVal</span><span class=p>,</span> <span class=nx>newVal</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>attrName</span> <span class=o>==</span> <span class=s2>&#34;theme&#34;</span> <span class=o>&amp;&amp;</span> <span class=nx>newVal</span> <span class=o>&amp;&amp;</span> <span class=nx>oldVal</span> <span class=o>!==</span> <span class=nx>newVal</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=c1>// act on new theme
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Using a lookup table we can then handle predefined themes, which makes it easier to embed. If the given value is not found in the table, we assume that it must be an url to an external file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>themes</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>default</span><span class=o>:</span> <span class=s2>&#34;assets/themes/default.json&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>dark</span><span class=o>:</span> <span class=s2>&#34;assets/themes/dark.json&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>url</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>themes</span><span class=p>[</span><span class=nx>newVal</span><span class=p>]</span> <span class=o>??</span> <span class=nx>newVal</span><span class=p>;</span>
</span></span></code></pre></div><p>The corresponding internal or external file is then loaded, parsed as json and each css property is updated. You can find an example for such theme file on <a href=https://xyquadrat.ch/polyring/assets/themes/default.json target=_blank rel="noopener noreffer">xyquadrat</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=nx>url</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>val</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>item</span> <span class=k>in</span> <span class=nx>val</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        	<span class=k>this</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>setProperty</span><span class=p>(</span><span class=nx>item</span><span class=p>,</span> <span class=nx>val</span><span class=p>[</span><span class=nx>item</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>         <span class=p>}</span>              
</span></span><span class=line><span class=cl>	<span class=p>}).</span><span class=k>catch</span><span class=p>(</span> <span class=nx>val</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    	<span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>val</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span> 
</span></span></code></pre></div><h3 id=css-setup>CSS setup</h3><p>A <a href=https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties target=_blank rel="noopener noreffer">css variable</a> or css custom property can be used with the <code>var</code> function in css. For example for the webring-banner:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>webring-banner</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>background-color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>background</span><span class=o>-</span><span class=kc>color</span><span class=p>,</span> <span class=mh>#FFF</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>border</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>solid</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>outer</span><span class=o>-</span><span class=n>border</span><span class=o>-</span><span class=kc>color</span><span class=p>,</span> <span class=mh>#DDD</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Take note that <code>var</code>allows passing a default value in the format: <code>var(--my-variable, default_value)</code>, but it is not necessary. Basically every kind of css parameter can be used in a variable, so you could have dynamic borders or even hide an element in one theme. These variables can also be stacked to allow for both broad and specific control:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=p>.</span><span class=nc>webring-banner__info</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>border</span><span class=p>:</span> <span class=mi>2</span><span class=kt>px</span> <span class=kc>solid</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>inner</span><span class=o>-</span><span class=n>border</span><span class=o>-</span><span class=kc>color</span><span class=p>,</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>outer</span><span class=o>-</span><span class=n>border</span><span class=o>-</span><span class=kc>color</span><span class=p>,</span> <span class=mh>#DDD</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Additionally if you&rsquo;re using scss and aren&rsquo;t keen on repeating the same var function for each component that uses these properties, you can integrate them with scss variables:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-scss data-lang=scss><span class=line><span class=cl><span class=nv>$text-color</span><span class=o> :</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>core-text-color</span><span class=o>,</span> <span class=no>black</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nc>.text</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=na>color</span><span class=o>:</span> <span class=nv>$text-color</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Unfortunately these css custom properties can not be used in scss functions like <code>scale-color</code>. As those are parsed at build time, but the value from a css variables is only present at run time. However css variables can be used in css functions like <code>calc</code>.</p><h3 id=conclusion>Conclusion</h3><p>Css custom properties allow for relatively easy theme support both to your website as well as webcomponents. Many css frameworks like <a href=https://materializecss.com/ target=_blank rel="noopener noreffer">Materialize</a> or <a href=https://getbootstrap.com/ target=_blank rel="noopener noreffer">Bootstrap</a> make heavy use of css variables to style elements dynamically.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 27.04.2021</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/css/>css</a>,&nbsp;<a href=/tags/javascript/>javascript</a>,&nbsp;<a href=/tags/web-component/>web component</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/using-steganography-to-send-messages-hidden-in-an-image/ class=prev rel=prev title="Using steganography to send messages hidden in an image"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Using steganography to send messages hidden in an image</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2021 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>gewlar</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>